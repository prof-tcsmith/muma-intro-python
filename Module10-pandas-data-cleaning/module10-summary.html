<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Smith">

<title>Module 10 Summary: Data Manipulation and Cleaning with Pandas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="module10-summary_files/libs/clipboard/clipboard.min.js"></script>
<script src="module10-summary_files/libs/quarto-html/quarto.js"></script>
<script src="module10-summary_files/libs/quarto-html/popper.min.js"></script>
<script src="module10-summary_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="module10-summary_files/libs/quarto-html/anchor.min.js"></script>
<link href="module10-summary_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="module10-summary_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="module10-summary_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="module10-summary_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="module10-summary_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="module10-summary_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="module10-summary_files/libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<meta name="version" content="0.8.6">
<meta name="course" content="ISM2411 Python for Business">
<style>
/* Canvas iframe optimization */
@media screen {
  body.in-iframe {
    margin: 0;
    padding: 15px;
    max-width: 100%;
  }
  .in-iframe .quarto-container {
    max-width: 100%;
    padding: 0 15px;
  }
  .in-iframe #quarto-content {
    max-width: 100%;
  }
  .in-iframe .page-layout-article {
    grid-template-columns: minmax(0, 1fr);
  }
  .in-iframe .sidebar {
    width: 200px;
  }
  .in-iframe .column-body {
    grid-column: 1;
    max-width: 100%;
  }
  .in-iframe pre {
    overflow-x: auto;
    max-width: 100%;
  }
  .in-iframe table {
    display: block;
    overflow-x: auto;
  }
  .in-iframe img {
    max-width: 100%;
    height: auto;
  }
}
</style>
<script>
if (window.self !== window.top) {
  document.addEventListener("DOMContentLoaded", function() {
    document.body.classList.add("in-iframe");
  });
}
</script>


<link rel="stylesheet" href="../canvas-width-fix.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#module-10-overview" id="toc-module-10-overview" class="nav-link active" data-scroll-target="#module-10-overview">Module 10 Overview</a></li>
  <li><a href="#what-we-learned" id="toc-what-we-learned" class="nav-link" data-scroll-target="#what-we-learned">What We Learned</a></li>
  <li><a href="#mind-map-module-10-content" id="toc-mind-map-module-10-content" class="nav-link" data-scroll-target="#mind-map-module-10-content">Mind Map: Module 10 Content</a></li>
  <li><a href="#handling-missing-data" id="toc-handling-missing-data" class="nav-link" data-scroll-target="#handling-missing-data">1. Handling Missing Data</a>
  <ul class="collapse">
  <li><a href="#detecting-missing-values-review" id="toc-detecting-missing-values-review" class="nav-link" data-scroll-target="#detecting-missing-values-review">1.1 Detecting Missing Values (Review)</a></li>
  <li><a href="#dropping-missing-values-.dropna" id="toc-dropping-missing-values-.dropna" class="nav-link" data-scroll-target="#dropping-missing-values-.dropna">1.2 Dropping Missing Values (<code>.dropna()</code>)</a></li>
  <li><a href="#filling-missing-values-.fillna" id="toc-filling-missing-values-.fillna" class="nav-link" data-scroll-target="#filling-missing-values-.fillna">1.3 Filling Missing Values (<code>.fillna()</code>)</a></li>
  </ul></li>
  <li><a href="#correcting-data-types" id="toc-correcting-data-types" class="nav-link" data-scroll-target="#correcting-data-types">2. Correcting Data Types</a>
  <ul class="collapse">
  <li><a href="#checking-current-data-types" id="toc-checking-current-data-types" class="nav-link" data-scroll-target="#checking-current-data-types">2.1 Checking Current Data Types</a></li>
  <li><a href="#converting-with-.astype" id="toc-converting-with-.astype" class="nav-link" data-scroll-target="#converting-with-.astype">2.2 Converting with <code>.astype()</code></a></li>
  <li><a href="#robust-conversions-pd.to_numeric-and-pd.to_datetime" id="toc-robust-conversions-pd.to_numeric-and-pd.to_datetime" class="nav-link" data-scroll-target="#robust-conversions-pd.to_numeric-and-pd.to_datetime">2.3 Robust Conversions: <code>pd.to_numeric()</code> and <code>pd.to_datetime()</code></a></li>
  </ul></li>
  <li><a href="#modifying-columns" id="toc-modifying-columns" class="nav-link" data-scroll-target="#modifying-columns">3. Modifying Columns</a>
  <ul class="collapse">
  <li><a href="#adding-new-columns" id="toc-adding-new-columns" class="nav-link" data-scroll-target="#adding-new-columns">3.1 Adding New Columns</a></li>
  <li><a href="#removing-columns" id="toc-removing-columns" class="nav-link" data-scroll-target="#removing-columns">3.2 Removing Columns</a></li>
  <li><a href="#renaming-columns" id="toc-renaming-columns" class="nav-link" data-scroll-target="#renaming-columns">3.3 Renaming Columns</a></li>
  </ul></li>
  <li><a href="#applying-functions-and-string-operations" id="toc-applying-functions-and-string-operations" class="nav-link" data-scroll-target="#applying-functions-and-string-operations">4. Applying Functions and String Operations</a>
  <ul class="collapse">
  <li><a href="#applying-functions-with-.apply" id="toc-applying-functions-with-.apply" class="nav-link" data-scroll-target="#applying-functions-with-.apply">4.1 Applying Functions with <code>.apply()</code></a></li>
  <li><a href="#element-wise-transformation-with-.map" id="toc-element-wise-transformation-with-.map" class="nav-link" data-scroll-target="#element-wise-transformation-with-.map">4.2 Element-wise Transformation with <code>.map()</code></a></li>
  <li><a href="#string-operations-with-.str" id="toc-string-operations-with-.str" class="nav-link" data-scroll-target="#string-operations-with-.str">4.3 String Operations with <code>.str</code></a></li>
  </ul></li>
  <li><a href="#sorting-data" id="toc-sorting-data" class="nav-link" data-scroll-target="#sorting-data">5. Sorting Data</a>
  <ul class="collapse">
  <li><a href="#sorting-by-values-.sort_values" id="toc-sorting-by-values-.sort_values" class="nav-link" data-scroll-target="#sorting-by-values-.sort_values">5.1 Sorting by Values (<code>.sort_values()</code>)</a></li>
  <li><a href="#sorting-by-index-.sort_index" id="toc-sorting-by-index-.sort_index" class="nav-link" data-scroll-target="#sorting-by-index-.sort_index">5.2 Sorting by Index (<code>.sort_index()</code>)</a></li>
  </ul></li>
  <li><a href="#managing-duplicates" id="toc-managing-duplicates" class="nav-link" data-scroll-target="#managing-duplicates">6. Managing Duplicates</a>
  <ul class="collapse">
  <li><a href="#identifying-duplicates-.duplicated" id="toc-identifying-duplicates-.duplicated" class="nav-link" data-scroll-target="#identifying-duplicates-.duplicated">6.1 Identifying Duplicates (<code>.duplicated()</code>)</a></li>
  <li><a href="#removing-duplicates-.drop_duplicates" id="toc-removing-duplicates-.drop_duplicates" class="nav-link" data-scroll-target="#removing-duplicates-.drop_duplicates">6.2 Removing Duplicates (<code>.drop_duplicates()</code>)</a></li>
  </ul></li>
  <li><a href="#applied-business-example-cleaning-sales-data" id="toc-applied-business-example-cleaning-sales-data" class="nav-link" data-scroll-target="#applied-business-example-cleaning-sales-data">7. Applied Business Example: Cleaning Sales Data</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">8. Key Takeaways</a></li>
  <li><a href="#practice-exercises" id="toc-practice-exercises" class="nav-link" data-scroll-target="#practice-exercises">Practice Exercises</a></li>
  <li><a href="#resources-for-further-learning" id="toc-resources-for-further-learning" class="nav-link" data-scroll-target="#resources-for-further-learning">Resources for Further Learning</a>
  <ul class="collapse">
  <li><a href="#official-documentation" id="toc-official-documentation" class="nav-link" data-scroll-target="#official-documentation">Official Documentation</a></li>
  <li><a href="#online-tutorials-and-courses" id="toc-online-tutorials-and-courses" class="nav-link" data-scroll-target="#online-tutorials-and-courses">Online Tutorials and Courses</a></li>
  <li><a href="#books" id="toc-books" class="nav-link" data-scroll-target="#books">Books</a></li>
  </ul></li>
  <li><a href="#glossary" id="toc-glossary" class="nav-link" data-scroll-target="#glossary">Glossary</a></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps">Next Steps</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<div class="quarto-title-block default">
  <div class="quarto-title">
    <h1 class="title">Module 10 Summary: Data Manipulation and Cleaning with Pandas</h1>
      </div>
  
  <div class="quarto-title-meta">
    <div class="quarto-title-meta-contents">
      <div class="course-header-info">
        <div class="course-meta-row">
          <span class="course-label">Course:</span>
          <span class="course-value">ISM2411 Python for Business</span>
        </div>
        
        <div class="author-meta-row">
          <span class="author-label">Instructor:</span>
          <span class="author-value">Dr.&nbsp;Smith</span>
          <span class="version-divider">•</span>
          <span class="version-label">Version:</span>
          <span class="version-value">0.8.6</span>
                    <span class="institute-divider">•</span>
          <span class="institute-value">University of South Florida</span>
                  </div>
        
              </div>
    </div>
  </div>
</div>

<style>
.quarto-title-block {
  margin-bottom: 2rem;
  border-bottom: 3px solid #31BAE9;
  padding-bottom: 1.5rem;
}

.quarto-title {
  margin-bottom: 1rem;
}

.title {
  font-size: 2.5rem;
  font-weight: 700;
  color: #2c3e50;
  margin-bottom: 0.5rem;
}

.subtitle {
  font-size: 1.3rem;
  color: #7f8c8d;
  font-weight: 400;
}

.course-header-info {
  background-color: #f8f9fa;
  padding: 1rem 1.5rem;
  border-radius: 8px;
  border-left: 4px solid #31BAE9;
}

.course-meta-row,
.author-meta-row,
.date-meta-row {
  margin-bottom: 0.5rem;
  font-size: 1.1rem;
}

.course-meta-row:last-child,
.author-meta-row:last-child,
.date-meta-row:last-child {
  margin-bottom: 0;
}

.course-label,
.version-label,
.author-label,
.date-label {
  font-weight: 600;
  color: #34495e;
  margin-right: 0.5rem;
}

.course-value,
.version-value,
.author-value,
.institute-value,
.date-value {
  color: #2c3e50;
}

.version-divider,
.institute-divider {
  margin: 0 1rem;
  color: #bdc3c7;
  font-weight: 300;
}

.course-value {
  font-weight: 500;
  color: #31BAE9;
}

.version-value {
  font-family: 'Courier New', monospace;
  background-color: #e8f4f8;
  padding: 0.1rem 0.4rem;
  border-radius: 4px;
  font-size: 0.95em;
}

/* Responsive design */
@media (max-width: 768px) {
  .title {
    font-size: 2rem;
  }
  
  .subtitle {
    font-size: 1.1rem;
  }
  
  .course-header-info {
    padding: 0.8rem 1rem;
  }
  
  .course-meta-row,
  .author-meta-row,
  .date-meta-row {
    font-size: 1rem;
    display: flex;
    flex-wrap: wrap;
  }
  
  .version-divider,
  .institute-divider {
    display: none;
  }
  
  .version-label,
  .institute-value {
    display: block;
    width: 100%;
    margin-top: 0.3rem;
  }
}

/* Print styles */
@media print {
  .quarto-title-block {
    border-bottom-width: 1px;
    margin-bottom: 1rem;
  }
  
  .course-header-info {
    background-color: transparent;
    border: 1px solid #ddd;
    padding: 0.5rem 1rem;
  }
}
</style>


<style>
figure figcaption {
    text-align: center;
}
</style>
<section id="module-10-overview" class="level2">
<h2 class="anchored" data-anchor-id="module-10-overview">Module 10 Overview</h2>
<p>This document provides a concise summary of what we covered in Module 10, which builds upon our introduction to Pandas in Module 9. While Module 9 focused on creating, inspecting, and selecting data from Pandas objects, Module 10 expands our toolkit to clean, transform, and manipulate data - essential skills for preparing real-world business datasets for meaningful analysis.</p>
</section>
<section id="what-we-learned" class="level2">
<h2 class="anchored" data-anchor-id="what-we-learned">What We Learned</h2>
<p>In Module 10, we covered:</p>
<ol type="1">
<li><p><strong>Handling Missing Data</strong>: Strategies for dealing with missing values using <code>.dropna()</code> and <code>.fillna()</code> methods</p></li>
<li><p><strong>Correcting Data Types</strong>: Techniques to convert columns to appropriate data types using <code>.astype()</code>, <code>pd.to_numeric()</code>, and <code>pd.to_datetime()</code></p></li>
<li><p><strong>Modifying DataFrame Structure</strong>: Adding, removing, and renaming columns</p></li>
<li><p><strong>Applying Functions</strong>: Using <code>.apply()</code> and <code>.map()</code> to transform data with custom functions</p></li>
<li><p><strong>String Operations</strong>: Manipulating text data with the <code>.str</code> accessor</p></li>
<li><p><strong>Sorting Data</strong>: Ordering DataFrames by values or index labels</p></li>
<li><p><strong>Managing Duplicates</strong>: Identifying and removing duplicate rows</p></li>
</ol>
<p>Let’s review each of these key areas briefly.</p>
</section>
<section id="mind-map-module-10-content" class="level2">
<h2 class="anchored" data-anchor-id="mind-map-module-10-content">Mind Map: Module 10 Content</h2>
<div style="overflow-x: auto;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/mindmaps/module10-mindmap.svg" style="width:100.0%" height="250" class="figure-img"></p>
<figcaption>Module 10 Mind Map</figcaption>
</figure>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled" style="font-size: 0.8em;">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Download Mind Map
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><a href="../images/mindmaps/module10-mindmap.svg" target="_blank">Download the Module 10 Mind Map (SVG)</a></p>
</div>
</div>
</div>
</section>
<section id="handling-missing-data" class="level1">
<h1>1. Handling Missing Data</h1>
<p>Real-world datasets often contain missing values (represented as <code>NaN</code> in Pandas). These gaps must be addressed before meaningful analysis can occur.</p>
<section id="detecting-missing-values-review" class="level2">
<h2 class="anchored" data-anchor-id="detecting-missing-values-review">1.1 Detecting Missing Values (Review)</h2>
<p>As covered in Module 9, we can detect missing values using:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># Sample data with missing values</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>data <span class="op">=</span> {</span>
<span id="cb1-6"><a href="#cb1-6"></a>    <span class="st">'Product'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="va">None</span>, <span class="st">'D'</span>],</span>
<span id="cb1-7"><a href="#cb1-7"></a>    <span class="st">'Price'</span>: [<span class="fl">10.0</span>, np.nan, <span class="fl">15.0</span>, <span class="fl">20.0</span>],</span>
<span id="cb1-8"><a href="#cb1-8"></a>    <span class="st">'Quantity'</span>: [<span class="dv">100</span>, <span class="dv">50</span>, np.nan, <span class="dv">80</span>]</span>
<span id="cb1-9"><a href="#cb1-9"></a>}</span>
<span id="cb1-10"><a href="#cb1-10"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co"># Check missing values</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="bu">print</span>(<span class="st">"Missing values per column:"</span>)</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="bu">print</span>(df.isnull().<span class="bu">sum</span>())</span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co"># Boolean mask of missing values</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Boolean mask of missing values:"</span>)</span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="bu">print</span>(df.isnull())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="dropping-missing-values-.dropna" class="level2">
<h2 class="anchored" data-anchor-id="dropping-missing-values-.dropna">1.2 Dropping Missing Values (<code>.dropna()</code>)</h2>
<p>When missing values represent a small portion of your data, removing them can be a simple solution:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># Sample data</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>data <span class="op">=</span> {</span>
<span id="cb2-6"><a href="#cb2-6"></a>    <span class="st">'Product'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="va">None</span>, <span class="st">'D'</span>, <span class="st">'E'</span>],</span>
<span id="cb2-7"><a href="#cb2-7"></a>    <span class="st">'Price'</span>: [<span class="fl">10.0</span>, np.nan, <span class="fl">15.0</span>, <span class="fl">20.0</span>, <span class="fl">25.0</span>],</span>
<span id="cb2-8"><a href="#cb2-8"></a>    <span class="st">'Quantity'</span>: [<span class="dv">100</span>, <span class="dv">50</span>, np.nan, <span class="dv">80</span>, <span class="dv">75</span>]</span>
<span id="cb2-9"><a href="#cb2-9"></a>}</span>
<span id="cb2-10"><a href="#cb2-10"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="bu">print</span>(<span class="st">"Original DataFrame:"</span>)</span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="bu">print</span>(df)</span>
<span id="cb2-13"><a href="#cb2-13"></a></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co"># Drop rows with ANY missing value</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>df_dropped <span class="op">=</span> df.dropna()</span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After dropping rows with any missing value:"</span>)</span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="bu">print</span>(df_dropped)</span>
<span id="cb2-18"><a href="#cb2-18"></a></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co"># Drop rows only if missing in specific columns</span></span>
<span id="cb2-20"><a href="#cb2-20"></a>df_dropped_subset <span class="op">=</span> df.dropna(subset<span class="op">=</span>[<span class="st">'Product'</span>])</span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After dropping rows with missing 'Product':"</span>)</span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="bu">print</span>(df_dropped_subset)</span>
<span id="cb2-23"><a href="#cb2-23"></a></span>
<span id="cb2-24"><a href="#cb2-24"></a><span class="co"># Drop columns with missing values</span></span>
<span id="cb2-25"><a href="#cb2-25"></a>df_dropped_cols <span class="op">=</span> df.dropna(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After dropping columns with any missing value:"</span>)</span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="bu">print</span>(df_dropped_cols)</span>
<span id="cb2-28"><a href="#cb2-28"></a></span>
<span id="cb2-29"><a href="#cb2-29"></a><span class="co"># Keep rows with at least 2 non-missing values</span></span>
<span id="cb2-30"><a href="#cb2-30"></a>df_dropped_thresh <span class="op">=</span> df.dropna(thresh<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb2-31"><a href="#cb2-31"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After keeping rows with at least 2 non-missing values:"</span>)</span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="bu">print</span>(df_dropped_thresh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Key parameters for <code>.dropna()</code>: - <code>axis</code>: Use <code>0</code> or <code>'index'</code> (default) to drop rows, <code>1</code> or <code>'columns'</code> to drop columns</p>
<ul>
<li><p><code>how</code>: <code>'any'</code> (default) drops if any value is missing, <code>'all'</code> drops only if all values are missing</p></li>
<li><p><code>thresh</code>: Minimum number of non-missing values required to keep a row/column</p></li>
<li><p><code>subset</code>: List of column names to consider when checking for missing values</p></li>
</ul>
</section>
<section id="filling-missing-values-.fillna" class="level2">
<h2 class="anchored" data-anchor-id="filling-missing-values-.fillna">1.3 Filling Missing Values (<code>.fillna()</code>)</h2>
<p>Often, you’ll want to preserve your data by replacing missing values with meaningful substitutes:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co"># Sample data</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>data <span class="op">=</span> {</span>
<span id="cb3-6"><a href="#cb3-6"></a>    <span class="st">'Product'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="va">None</span>, <span class="st">'D'</span>],</span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="st">'Price'</span>: [<span class="fl">10.0</span>, np.nan, <span class="fl">15.0</span>, <span class="fl">20.0</span>],</span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="st">'Quantity'</span>: [<span class="dv">100</span>, <span class="dv">50</span>, np.nan, <span class="dv">80</span>]</span>
<span id="cb3-9"><a href="#cb3-9"></a>}</span>
<span id="cb3-10"><a href="#cb3-10"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="bu">print</span>(<span class="st">"Original DataFrame:"</span>)</span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="bu">print</span>(df)</span>
<span id="cb3-13"><a href="#cb3-13"></a></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co"># Fill all missing values with a constant</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>df_filled_const <span class="op">=</span> df.fillna(<span class="dv">0</span>)  <span class="co"># Numeric columns get 0, object columns get '0'</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After filling all missing values with 0:"</span>)</span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="bu">print</span>(df_filled_const)</span>
<span id="cb3-18"><a href="#cb3-18"></a></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co"># Fill with different values per column</span></span>
<span id="cb3-20"><a href="#cb3-20"></a>fill_dict <span class="op">=</span> {<span class="st">'Product'</span>: <span class="st">'Unknown'</span>, <span class="st">'Price'</span>: <span class="fl">0.0</span>, <span class="st">'Quantity'</span>: df[<span class="st">'Quantity'</span>].mean()}</span>
<span id="cb3-21"><a href="#cb3-21"></a>df_filled_dict <span class="op">=</span> df.fillna(fill_dict)</span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After filling with column-specific values:"</span>)</span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="bu">print</span>(df_filled_dict)</span>
<span id="cb3-24"><a href="#cb3-24"></a></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="co"># Fill using forward fill (propagate last valid value)</span></span>
<span id="cb3-26"><a href="#cb3-26"></a>df_filled_ffill <span class="op">=</span> df.fillna(method<span class="op">=</span><span class="st">'ffill'</span>)</span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After forward filling:"</span>)</span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="bu">print</span>(df_filled_ffill)</span>
<span id="cb3-29"><a href="#cb3-29"></a></span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="co"># Fill using backward fill (use next valid value)</span></span>
<span id="cb3-31"><a href="#cb3-31"></a>df_filled_bfill <span class="op">=</span> df.fillna(method<span class="op">=</span><span class="st">'bfill'</span>)</span>
<span id="cb3-32"><a href="#cb3-32"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After backward filling:"</span>)</span>
<span id="cb3-33"><a href="#cb3-33"></a><span class="bu">print</span>(df_filled_bfill)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Key parameters for <code>.fillna()</code>: - <code>value</code>: The value to use for filling (can be a scalar, dict, Series, or DataFrame)</p>
<ul>
<li><p><code>method</code>: Strategy for filling - <code>'ffill'</code>/<code>'pad'</code> (forward) or <code>'bfill'</code>/<code>'backfill'</code> (backward)</p></li>
<li><p><code>axis</code>: Direction of filling (rows or columns)</p></li>
<li><p><code>inplace</code>: Whether to modify the original DataFrame</p></li>
</ul>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Choosing a Missing Data Strategy
</div>
</div>
<div class="callout-body-container callout-body">
<p>When deciding how to handle missing values, consider:</p>
<ol type="1">
<li><p><strong>Why is the data missing?</strong> Is it random or meaningful?</p></li>
<li><p><strong>How much data is missing?</strong> If a large percentage, dropping may not be viable.</p></li>
<li><p><strong>What’s the business context?</strong> Some analyses are sensitive to imputation methods.</p></li>
<li><p><strong>Impact on statistical properties:</strong> Some filling methods can distort your data’s distribution.</p></li>
</ol>
<p>For numerical data, common approaches include: - Mean/median/mode replacement (centrality measures)</p>
<ul>
<li><p>Forward/backward filling (time series data)</p></li>
<li><p>Zero replacement (when zero is meaningful)</p></li>
<li><p>Predictive imputation (more advanced)</p></li>
</ul>
</div>
</div>
</section>
</section>
<section id="correcting-data-types" class="level1">
<h1>2. Correcting Data Types</h1>
<p>Inappropriate data types can prevent calculations and hinder analysis. Converting columns to the right types is essential.</p>
<section id="checking-current-data-types" class="level2">
<h2 class="anchored" data-anchor-id="checking-current-data-types">2.1 Checking Current Data Types</h2>
<p>Always start by examining current data types:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># Sample data with potentially incorrect types</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>data <span class="op">=</span> {</span>
<span id="cb4-5"><a href="#cb4-5"></a>    <span class="st">'ID'</span>: [<span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span>, <span class="st">'4'</span>],</span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="st">'Price'</span>: [<span class="st">'10.5'</span>, <span class="st">'15.75'</span>, <span class="st">'8.25'</span>, <span class="st">'22.0'</span>],</span>
<span id="cb4-7"><a href="#cb4-7"></a>    <span class="st">'Quantity'</span>: [<span class="st">'100'</span>, <span class="st">'50'</span>, <span class="st">'75'</span>, <span class="st">'30'</span>],</span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="st">'Date'</span>: [<span class="st">'2025-04-15'</span>, <span class="st">'2025-04-16'</span>, <span class="st">'2025-04-17'</span>, <span class="st">'2025-04-18'</span>]</span>
<span id="cb4-9"><a href="#cb4-9"></a>}</span>
<span id="cb4-10"><a href="#cb4-10"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb4-11"><a href="#cb4-11"></a></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co"># Check current types</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="bu">print</span>(<span class="st">"Initial data types:"</span>)</span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="bu">print</span>(df.dtypes)  <span class="co"># All likely 'object' (string)</span></span>
<span id="cb4-15"><a href="#cb4-15"></a></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co"># More detailed info</span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">DataFrame info:"</span>)</span>
<span id="cb4-18"><a href="#cb4-18"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="converting-with-.astype" class="level2">
<h2 class="anchored" data-anchor-id="converting-with-.astype">2.2 Converting with <code>.astype()</code></h2>
<p>The basic method for type conversion is <code>.astype()</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># Sample data with string-based numbers</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>data <span class="op">=</span> {</span>
<span id="cb5-5"><a href="#cb5-5"></a>    <span class="st">'ID'</span>: [<span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span>, <span class="st">'4'</span>],</span>
<span id="cb5-6"><a href="#cb5-6"></a>    <span class="st">'Price'</span>: [<span class="st">'10.5'</span>, <span class="st">'15.75'</span>, <span class="st">'8.25'</span>, <span class="st">'22.0'</span>],</span>
<span id="cb5-7"><a href="#cb5-7"></a>    <span class="st">'Quantity'</span>: [<span class="st">'100'</span>, <span class="st">'50'</span>, <span class="st">'75'</span>, <span class="st">'30'</span>],</span>
<span id="cb5-8"><a href="#cb5-8"></a>    <span class="st">'Date'</span>: [<span class="st">'2025-04-15'</span>, <span class="st">'2025-04-16'</span>, <span class="st">'2025-04-17'</span>, <span class="st">'2025-04-18'</span>]</span>
<span id="cb5-9"><a href="#cb5-9"></a>}</span>
<span id="cb5-10"><a href="#cb5-10"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb5-11"><a href="#cb5-11"></a></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co"># Convert types with astype</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>df[<span class="st">'ID'</span>] <span class="op">=</span> df[<span class="st">'ID'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb5-14"><a href="#cb5-14"></a>df[<span class="st">'Price'</span>] <span class="op">=</span> df[<span class="st">'Price'</span>].astype(<span class="bu">float</span>)</span>
<span id="cb5-15"><a href="#cb5-15"></a>df[<span class="st">'Quantity'</span>] <span class="op">=</span> df[<span class="st">'Quantity'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co"># Simple date conversion (limited flexibility)</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>df[<span class="st">'Date'</span>] <span class="op">=</span> df[<span class="st">'Date'</span>].astype(<span class="st">'datetime64[ns]'</span>)</span>
<span id="cb5-18"><a href="#cb5-18"></a></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="bu">print</span>(<span class="st">"DataFrame after type conversion:"</span>)</span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="bu">print</span>(df)</span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">New data types:"</span>)</span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="bu">print</span>(df.dtypes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Common types to convert to: - <code>int</code>, <code>float</code>: Numeric data</p>
<ul>
<li><p><code>str</code>: String data</p></li>
<li><p><code>bool</code>: Boolean data</p></li>
<li><p><code>datetime64[ns]</code>: Date/time data</p></li>
<li><p><code>category</code>: Categorical data (memory efficient for repeated values)</p></li>
</ul>
</section>
<section id="robust-conversions-pd.to_numeric-and-pd.to_datetime" class="level2">
<h2 class="anchored" data-anchor-id="robust-conversions-pd.to_numeric-and-pd.to_datetime">2.3 Robust Conversions: <code>pd.to_numeric()</code> and <code>pd.to_datetime()</code></h2>
<p>For handling problematic data, Pandas provides specialized conversion functions:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co"># Sample data with problematic values</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>data <span class="op">=</span> {</span>
<span id="cb6-5"><a href="#cb6-5"></a>    <span class="st">'Sales'</span>: [<span class="st">'1000'</span>, <span class="st">'1,500'</span>, <span class="st">'N/A'</span>, <span class="st">'2,250.50'</span>],</span>
<span id="cb6-6"><a href="#cb6-6"></a>    <span class="st">'Date'</span>: [<span class="st">'2025-04-15'</span>, <span class="st">'04/16/2025'</span>, <span class="st">'Invalid'</span>, <span class="st">'2025.04.17'</span>]</span>
<span id="cb6-7"><a href="#cb6-7"></a>}</span>
<span id="cb6-8"><a href="#cb6-8"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="bu">print</span>(<span class="st">"Original DataFrame:"</span>)</span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="bu">print</span>(df)</span>
<span id="cb6-11"><a href="#cb6-11"></a></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co"># Clean and convert Sales using to_numeric</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co"># First, remove commas</span></span>
<span id="cb6-14"><a href="#cb6-14"></a>df[<span class="st">'Sales_Clean'</span>] <span class="op">=</span> df[<span class="st">'Sales'</span>].<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>)</span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co"># Convert to numeric, coercing errors to NaN</span></span>
<span id="cb6-16"><a href="#cb6-16"></a>df[<span class="st">'Sales_Numeric'</span>] <span class="op">=</span> pd.to_numeric(df[<span class="st">'Sales_Clean'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb6-17"><a href="#cb6-17"></a></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co"># Convert Date column with to_datetime</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>df[<span class="st">'Date_DT'</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">'Date'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb6-20"><a href="#cb6-20"></a></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">DataFrame after conversion:"</span>)</span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="bu">print</span>(df)</span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">New data types:"</span>)</span>
<span id="cb6-24"><a href="#cb6-24"></a><span class="bu">print</span>(df.dtypes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Key advantages of specialized conversion functions: - <strong>Error handling options</strong>: - <code>errors='raise'</code>: Raise exception on invalid data (default)</p>
<ul>
<li><p><code>errors='coerce'</code>: Convert invalid data to NaN</p></li>
<li><p><code>errors='ignore'</code>: Return input when conversion fails</p></li>
<li><p><strong>Format specification</strong> for <code>pd.to_datetime()</code>: Define custom date formats with format codes</p></li>
</ul>
</section>
</section>
<section id="modifying-columns" class="level1">
<h1>3. Modifying Columns</h1>
<p>Datasets often need structural modifications - adding calculated columns, removing irrelevant ones, or renaming for clarity.</p>
<section id="adding-new-columns" class="level2">
<h2 class="anchored" data-anchor-id="adding-new-columns">3.1 Adding New Columns</h2>
<p>Creating new columns is straightforward with direct assignment:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co"># Sample sales data</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>data <span class="op">=</span> {</span>
<span id="cb7-5"><a href="#cb7-5"></a>    <span class="st">'Product'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>],</span>
<span id="cb7-6"><a href="#cb7-6"></a>    <span class="st">'Price'</span>: [<span class="fl">10.0</span>, <span class="fl">20.0</span>, <span class="fl">15.0</span>, <span class="fl">25.0</span>],</span>
<span id="cb7-7"><a href="#cb7-7"></a>    <span class="st">'Quantity'</span>: [<span class="dv">100</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">30</span>]</span>
<span id="cb7-8"><a href="#cb7-8"></a>}</span>
<span id="cb7-9"><a href="#cb7-9"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="bu">print</span>(<span class="st">"Original DataFrame:"</span>)</span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="bu">print</span>(df)</span>
<span id="cb7-12"><a href="#cb7-12"></a></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co"># Add a constant column</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>df[<span class="st">'Category'</span>] <span class="op">=</span> <span class="st">'Electronics'</span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After adding constant column:"</span>)</span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="bu">print</span>(df)</span>
<span id="cb7-17"><a href="#cb7-17"></a></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co"># Add a calculated column</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>df[<span class="st">'Revenue'</span>] <span class="op">=</span> df[<span class="st">'Price'</span>] <span class="op">*</span> df[<span class="st">'Quantity'</span>]</span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After adding calculated column:"</span>)</span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="bu">print</span>(df)</span>
<span id="cb7-22"><a href="#cb7-22"></a></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co"># Add conditional column</span></span>
<span id="cb7-24"><a href="#cb7-24"></a>df[<span class="st">'Size'</span>] <span class="op">=</span> <span class="st">'Medium'</span>  <span class="co"># Default value</span></span>
<span id="cb7-25"><a href="#cb7-25"></a>df.loc[df[<span class="st">'Quantity'</span>] <span class="op">&lt;</span> <span class="dv">50</span>, <span class="st">'Size'</span>] <span class="op">=</span> <span class="st">'Small'</span></span>
<span id="cb7-26"><a href="#cb7-26"></a>df.loc[df[<span class="st">'Quantity'</span>] <span class="op">&gt;</span> <span class="dv">80</span>, <span class="st">'Size'</span>] <span class="op">=</span> <span class="st">'Large'</span></span>
<span id="cb7-27"><a href="#cb7-27"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After adding conditional column:"</span>)</span>
<span id="cb7-28"><a href="#cb7-28"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="removing-columns" class="level2">
<h2 class="anchored" data-anchor-id="removing-columns">3.2 Removing Columns</h2>
<p>Use <code>.drop()</code> to remove unwanted columns:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co"># Sample data with unnecessary columns</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>data <span class="op">=</span> {</span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="st">'ID'</span>: [<span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span>, <span class="st">'4'</span>],</span>
<span id="cb8-6"><a href="#cb8-6"></a>    <span class="st">'Product'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>],</span>
<span id="cb8-7"><a href="#cb8-7"></a>    <span class="st">'Price'</span>: [<span class="fl">10.0</span>, <span class="fl">20.0</span>, <span class="fl">15.0</span>, <span class="fl">25.0</span>],</span>
<span id="cb8-8"><a href="#cb8-8"></a>    <span class="st">'Quantity'</span>: [<span class="dv">100</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">30</span>],</span>
<span id="cb8-9"><a href="#cb8-9"></a>    <span class="st">'Internal_Code'</span>: [<span class="st">'X1'</span>, <span class="st">'Y2'</span>, <span class="st">'Z3'</span>, <span class="st">'W4'</span>],  <span class="co"># Column to remove</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="st">'Temp_Note'</span>: [<span class="st">'Note1'</span>, <span class="st">'Note2'</span>, <span class="st">'Note3'</span>, <span class="st">'Note4'</span>]  <span class="co"># Another column to remove</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>}</span>
<span id="cb8-12"><a href="#cb8-12"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="bu">print</span>(<span class="st">"Original DataFrame:"</span>)</span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="bu">print</span>(df)</span>
<span id="cb8-15"><a href="#cb8-15"></a></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co"># Remove a single column</span></span>
<span id="cb8-17"><a href="#cb8-17"></a>df_dropped_single <span class="op">=</span> df.drop(columns<span class="op">=</span><span class="st">'Internal_Code'</span>)</span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After dropping 'Internal_Code':"</span>)</span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="bu">print</span>(df_dropped_single)</span>
<span id="cb8-20"><a href="#cb8-20"></a></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="co"># Remove multiple columns</span></span>
<span id="cb8-22"><a href="#cb8-22"></a>columns_to_drop <span class="op">=</span> [<span class="st">'Internal_Code'</span>, <span class="st">'Temp_Note'</span>]</span>
<span id="cb8-23"><a href="#cb8-23"></a>df_dropped_multi <span class="op">=</span> df.drop(columns<span class="op">=</span>columns_to_drop)</span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After dropping multiple columns:"</span>)</span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="bu">print</span>(df_dropped_multi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Two main ways to use <code>.drop()</code> for columns: 1. <code>df.drop('column_name', axis=1)</code> - using axis parameter</p>
<ol start="2" type="1">
<li><code>df.drop(columns='column_name')</code> - using the columns parameter (more explicit and readable)</li>
</ol>
</section>
<section id="renaming-columns" class="level2">
<h2 class="anchored" data-anchor-id="renaming-columns">3.3 Renaming Columns</h2>
<p>Clear column names improve code readability and analysis. Use <code>.rename()</code> to change column names:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co"># Sample data with unclear column names</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>data <span class="op">=</span> {</span>
<span id="cb9-5"><a href="#cb9-5"></a>    <span class="st">'prod_id'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb9-6"><a href="#cb9-6"></a>    <span class="st">'prod_nm'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>],</span>
<span id="cb9-7"><a href="#cb9-7"></a>    <span class="st">'p'</span>: [<span class="fl">10.0</span>, <span class="fl">20.0</span>, <span class="fl">15.0</span>, <span class="fl">25.0</span>],</span>
<span id="cb9-8"><a href="#cb9-8"></a>    <span class="st">'qty'</span>: [<span class="dv">100</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">30</span>]</span>
<span id="cb9-9"><a href="#cb9-9"></a>}</span>
<span id="cb9-10"><a href="#cb9-10"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="bu">print</span>(<span class="st">"Original DataFrame with unclear names:"</span>)</span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="bu">print</span>(df)</span>
<span id="cb9-13"><a href="#cb9-13"></a></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co"># Rename columns using a dictionary mapping</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>renamed_df <span class="op">=</span> df.rename(columns<span class="op">=</span>{</span>
<span id="cb9-16"><a href="#cb9-16"></a>    <span class="st">'prod_id'</span>: <span class="st">'ProductID'</span>,</span>
<span id="cb9-17"><a href="#cb9-17"></a>    <span class="st">'prod_nm'</span>: <span class="st">'ProductName'</span>,</span>
<span id="cb9-18"><a href="#cb9-18"></a>    <span class="st">'p'</span>: <span class="st">'Price'</span>,</span>
<span id="cb9-19"><a href="#cb9-19"></a>    <span class="st">'qty'</span>: <span class="st">'Quantity'</span></span>
<span id="cb9-20"><a href="#cb9-20"></a>})</span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">DataFrame with renamed columns:"</span>)</span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="bu">print</span>(renamed_df)</span>
<span id="cb9-23"><a href="#cb9-23"></a></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co"># Rename just one column</span></span>
<span id="cb9-25"><a href="#cb9-25"></a>single_renamed_df <span class="op">=</span> df.rename(columns<span class="op">=</span>{<span class="st">'prod_nm'</span>: <span class="st">'Product'</span>})</span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">DataFrame with one renamed column:"</span>)</span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="bu">print</span>(single_renamed_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Key parameters for <code>.rename()</code>: - <code>columns</code>: Dictionary mapping old names to new names</p>
<ul>
<li><code>inplace</code>: Whether to modify the original DataFrame</li>
</ul>
</section>
</section>
<section id="applying-functions-and-string-operations" class="level1">
<h1>4. Applying Functions and String Operations</h1>
<p>Transforming data often requires custom functions or string manipulations.</p>
<section id="applying-functions-with-.apply" class="level2">
<h2 class="anchored" data-anchor-id="applying-functions-with-.apply">4.1 Applying Functions with <code>.apply()</code></h2>
<p>The <code>.apply()</code> method executes a function along an axis of a DataFrame:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co"># Sample data</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>data <span class="op">=</span> {</span>
<span id="cb10-6"><a href="#cb10-6"></a>    <span class="st">'A'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb10-7"><a href="#cb10-7"></a>    <span class="st">'B'</span>: [<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>],</span>
<span id="cb10-8"><a href="#cb10-8"></a>    <span class="st">'C'</span>: [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">400</span>]</span>
<span id="cb10-9"><a href="#cb10-9"></a>}</span>
<span id="cb10-10"><a href="#cb10-10"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="bu">print</span>(<span class="st">"Original DataFrame:"</span>)</span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="bu">print</span>(df)</span>
<span id="cb10-13"><a href="#cb10-13"></a></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co"># Apply a function to each column (axis=0)</span></span>
<span id="cb10-15"><a href="#cb10-15"></a>column_sums <span class="op">=</span> df.<span class="bu">apply</span>(np.<span class="bu">sum</span>)</span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Sum of each column:"</span>)</span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="bu">print</span>(column_sums)</span>
<span id="cb10-18"><a href="#cb10-18"></a></span>
<span id="cb10-19"><a href="#cb10-19"></a><span class="co"># Apply a function to each row (axis=1)</span></span>
<span id="cb10-20"><a href="#cb10-20"></a>row_means <span class="op">=</span> df.<span class="bu">apply</span>(np.mean, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Mean of each row:"</span>)</span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="bu">print</span>(row_means)</span>
<span id="cb10-23"><a href="#cb10-23"></a></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="co"># Apply a custom function to each column</span></span>
<span id="cb10-25"><a href="#cb10-25"></a><span class="kw">def</span> standardize(x):</span>
<span id="cb10-26"><a href="#cb10-26"></a>    <span class="cf">return</span> (x <span class="op">-</span> x.mean()) <span class="op">/</span> x.std()</span>
<span id="cb10-27"><a href="#cb10-27"></a></span>
<span id="cb10-28"><a href="#cb10-28"></a>df_standardized <span class="op">=</span> df.<span class="bu">apply</span>(standardize)</span>
<span id="cb10-29"><a href="#cb10-29"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Standardized columns:"</span>)</span>
<span id="cb10-30"><a href="#cb10-30"></a><span class="bu">print</span>(df_standardized)</span>
<span id="cb10-31"><a href="#cb10-31"></a></span>
<span id="cb10-32"><a href="#cb10-32"></a><span class="co"># Apply a lambda function to each row</span></span>
<span id="cb10-33"><a href="#cb10-33"></a>df[<span class="st">'D'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> row: row[<span class="st">'A'</span>] <span class="op">*</span> row[<span class="st">'C'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-34"><a href="#cb10-34"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">DataFrame with calculated column D:"</span>)</span>
<span id="cb10-35"><a href="#cb10-35"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Key aspects of <code>.apply()</code>: - <code>axis=0</code> (default): Apply function to each column</p>
<ul>
<li><p><code>axis=1</code>: Apply function to each row</p></li>
<li><p>Can use built-in functions, NumPy functions, or custom functions</p></li>
<li><p>Lambda functions work well for simple operations</p></li>
</ul>
</section>
<section id="element-wise-transformation-with-.map" class="level2">
<h2 class="anchored" data-anchor-id="element-wise-transformation-with-.map">4.2 Element-wise Transformation with <code>.map()</code></h2>
<p>The <code>.map()</code> method applies a function or mapping to each element in a Series:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co"># Sample data</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>data <span class="op">=</span> {</span>
<span id="cb11-5"><a href="#cb11-5"></a>    <span class="st">'ProductCode'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>],</span>
<span id="cb11-6"><a href="#cb11-6"></a>    <span class="st">'Category'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>],</span>
<span id="cb11-7"><a href="#cb11-7"></a>    <span class="st">'Rating'</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>]</span>
<span id="cb11-8"><a href="#cb11-8"></a>}</span>
<span id="cb11-9"><a href="#cb11-9"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="bu">print</span>(<span class="st">"Original DataFrame:"</span>)</span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="bu">print</span>(df)</span>
<span id="cb11-12"><a href="#cb11-12"></a></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co"># Map category codes to names using a dictionary</span></span>
<span id="cb11-14"><a href="#cb11-14"></a>category_map <span class="op">=</span> {<span class="dv">1</span>: <span class="st">'Electronics'</span>, <span class="dv">2</span>: <span class="st">'Home Goods'</span>, <span class="dv">3</span>: <span class="st">'Office Supplies'</span>}</span>
<span id="cb11-15"><a href="#cb11-15"></a>df[<span class="st">'CategoryName'</span>] <span class="op">=</span> df[<span class="st">'Category'</span>].<span class="bu">map</span>(category_map)</span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After mapping categories:"</span>)</span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="bu">print</span>(df)</span>
<span id="cb11-18"><a href="#cb11-18"></a></span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="co"># Map ratings to descriptions using a function</span></span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="kw">def</span> rating_to_text(rating):</span>
<span id="cb11-21"><a href="#cb11-21"></a>    <span class="cf">if</span> rating <span class="op">&gt;=</span> <span class="dv">4</span>:</span>
<span id="cb11-22"><a href="#cb11-22"></a>        <span class="cf">return</span> <span class="st">'Excellent'</span></span>
<span id="cb11-23"><a href="#cb11-23"></a>    <span class="cf">elif</span> rating <span class="op">&gt;=</span> <span class="dv">3</span>:</span>
<span id="cb11-24"><a href="#cb11-24"></a>        <span class="cf">return</span> <span class="st">'Good'</span></span>
<span id="cb11-25"><a href="#cb11-25"></a>    <span class="cf">else</span>:</span>
<span id="cb11-26"><a href="#cb11-26"></a>        <span class="cf">return</span> <span class="st">'Average'</span></span>
<span id="cb11-27"><a href="#cb11-27"></a></span>
<span id="cb11-28"><a href="#cb11-28"></a>df[<span class="st">'RatingText'</span>] <span class="op">=</span> df[<span class="st">'Rating'</span>].<span class="bu">map</span>(rating_to_text)</span>
<span id="cb11-29"><a href="#cb11-29"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After mapping ratings to text:"</span>)</span>
<span id="cb11-30"><a href="#cb11-30"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Key differences between <code>.map()</code> and <code>.apply()</code>: - <code>.map()</code> is a Series method, while <code>.apply()</code> works on both Series and DataFrames</p>
<ul>
<li><p><code>.map()</code> is generally faster for element-wise operations</p></li>
<li><p><code>.map()</code> is ideal for value substitutions using dictionaries</p></li>
</ul>
</section>
<section id="string-operations-with-.str" class="level2">
<h2 class="anchored" data-anchor-id="string-operations-with-.str">4.3 String Operations with <code>.str</code></h2>
<p>Pandas provides vectorized string methods through the <code>.str</code> accessor:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co"># Sample text data</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>data <span class="op">=</span> {</span>
<span id="cb12-5"><a href="#cb12-5"></a>    <span class="st">'ProductName'</span>: [<span class="st">' Widget A '</span>, <span class="st">'widget b'</span>, <span class="st">'WIDGET C'</span>, <span class="st">'Gadget X'</span>],</span>
<span id="cb12-6"><a href="#cb12-6"></a>    <span class="st">'Description'</span>: [<span class="st">'Red Color, Size M'</span>, <span class="st">'BLUE color, size L'</span>, <span class="st">'green COLOR, Size S'</span>, <span class="st">'Yellow, Large'</span>],</span>
<span id="cb12-7"><a href="#cb12-7"></a>    <span class="st">'SKU'</span>: [<span class="st">'SKU-123-A'</span>, <span class="st">'SKU-456-B'</span>, <span class="st">'SKU-789-C'</span>, <span class="st">'SKU-101-X'</span>]</span>
<span id="cb12-8"><a href="#cb12-8"></a>}</span>
<span id="cb12-9"><a href="#cb12-9"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="bu">print</span>(<span class="st">"Original DataFrame:"</span>)</span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="bu">print</span>(df)</span>
<span id="cb12-12"><a href="#cb12-12"></a></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co"># Convert to lowercase and strip whitespace</span></span>
<span id="cb12-14"><a href="#cb12-14"></a>df[<span class="st">'ProductName_Clean'</span>] <span class="op">=</span> df[<span class="st">'ProductName'</span>].<span class="bu">str</span>.lower().<span class="bu">str</span>.strip()</span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Cleaned product names:"</span>)</span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="bu">print</span>(df[<span class="st">'ProductName_Clean'</span>])</span>
<span id="cb12-17"><a href="#cb12-17"></a></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="co"># Extract part of a string (SKU code)</span></span>
<span id="cb12-19"><a href="#cb12-19"></a>df[<span class="st">'SKU_Code'</span>] <span class="op">=</span> df[<span class="st">'SKU'</span>].<span class="bu">str</span>.split(<span class="st">'-'</span>).<span class="bu">str</span>[<span class="dv">1</span>]</span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Extracted SKU codes:"</span>)</span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="bu">print</span>(df[<span class="st">'SKU_Code'</span>])</span>
<span id="cb12-22"><a href="#cb12-22"></a></span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="co"># Check if string contains a substring</span></span>
<span id="cb12-24"><a href="#cb12-24"></a>df[<span class="st">'Is_Color_Red'</span>] <span class="op">=</span> df[<span class="st">'Description'</span>].<span class="bu">str</span>.contains(<span class="st">'red'</span>, case<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb12-25"><a href="#cb12-25"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Products with 'red' in description:"</span>)</span>
<span id="cb12-26"><a href="#cb12-26"></a><span class="bu">print</span>(df[[<span class="st">'Description'</span>, <span class="st">'Is_Color_Red'</span>]])</span>
<span id="cb12-27"><a href="#cb12-27"></a></span>
<span id="cb12-28"><a href="#cb12-28"></a><span class="co"># Replace text</span></span>
<span id="cb12-29"><a href="#cb12-29"></a>df[<span class="st">'Description_Standard'</span>] <span class="op">=</span> df[<span class="st">'Description'</span>].<span class="bu">str</span>.replace(<span class="st">'COLOR'</span>, <span class="st">'Color'</span>).<span class="bu">str</span>.replace(<span class="st">'color'</span>, <span class="st">'Color'</span>)</span>
<span id="cb12-30"><a href="#cb12-30"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Standardized descriptions:"</span>)</span>
<span id="cb12-31"><a href="#cb12-31"></a><span class="bu">print</span>(df[[<span class="st">'Description'</span>, <span class="st">'Description_Standard'</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Common string operations via the <code>.str</code> accessor: - <code>.lower()</code>, <code>.upper()</code>, <code>.title()</code>: Case conversion</p>
<ul>
<li><p><code>.strip()</code>, <code>.lstrip()</code>, <code>.rstrip()</code>: Remove whitespace</p></li>
<li><p><code>.replace(pattern, replacement)</code>: Replace substrings</p></li>
<li><p><code>.contains(pattern)</code>: Check if pattern exists (returns boolean)</p></li>
<li><p><code>.split(delimiter)</code>: Split into list of substrings</p></li>
<li><p><code>.extract(pattern)</code>: Extract using regular expressions (more advanced)</p></li>
</ul>
</section>
</section>
<section id="sorting-data" class="level1">
<h1>5. Sorting Data</h1>
<p>Organizing data in a meaningful order is often necessary for analysis and presentation.</p>
<section id="sorting-by-values-.sort_values" class="level2">
<h2 class="anchored" data-anchor-id="sorting-by-values-.sort_values">5.1 Sorting by Values (<code>.sort_values()</code>)</h2>
<p>Sort a DataFrame by one or more columns:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co"># Sample sales data</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>data <span class="op">=</span> {</span>
<span id="cb13-6"><a href="#cb13-6"></a>    <span class="st">'Product'</span>: [<span class="st">'B'</span>, <span class="st">'A'</span>, <span class="st">'C'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>],</span>
<span id="cb13-7"><a href="#cb13-7"></a>    <span class="st">'Region'</span>: [<span class="st">'North'</span>, <span class="st">'South'</span>, <span class="st">'North'</span>, <span class="st">'North'</span>, <span class="st">'South'</span>],</span>
<span id="cb13-8"><a href="#cb13-8"></a>    <span class="st">'Sales'</span>: [<span class="dv">200</span>, <span class="dv">150</span>, <span class="dv">100</span>, <span class="dv">160</span>, <span class="dv">190</span>]</span>
<span id="cb13-9"><a href="#cb13-9"></a>}</span>
<span id="cb13-10"><a href="#cb13-10"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="bu">print</span>(<span class="st">"Original DataFrame:"</span>)</span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="bu">print</span>(df)</span>
<span id="cb13-13"><a href="#cb13-13"></a></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co"># Sort by a single column (ascending)</span></span>
<span id="cb13-15"><a href="#cb13-15"></a>df_sorted_sales <span class="op">=</span> df.sort_values(by<span class="op">=</span><span class="st">'Sales'</span>)</span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Sorted by Sales (ascending):"</span>)</span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="bu">print</span>(df_sorted_sales)</span>
<span id="cb13-18"><a href="#cb13-18"></a></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co"># Sort by a single column (descending)</span></span>
<span id="cb13-20"><a href="#cb13-20"></a>df_sorted_sales_desc <span class="op">=</span> df.sort_values(by<span class="op">=</span><span class="st">'Sales'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Sorted by Sales (descending):"</span>)</span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="bu">print</span>(df_sorted_sales_desc)</span>
<span id="cb13-23"><a href="#cb13-23"></a></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="co"># Sort by multiple columns</span></span>
<span id="cb13-25"><a href="#cb13-25"></a>df_sorted_multi <span class="op">=</span> df.sort_values(by<span class="op">=</span>[<span class="st">'Product'</span>, <span class="st">'Sales'</span>], ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">False</span>])</span>
<span id="cb13-26"><a href="#cb13-26"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Sorted by Product (asc) then Sales (desc):"</span>)</span>
<span id="cb13-27"><a href="#cb13-27"></a><span class="bu">print</span>(df_sorted_multi)</span>
<span id="cb13-28"><a href="#cb13-28"></a></span>
<span id="cb13-29"><a href="#cb13-29"></a><span class="co"># Sort with NaN values</span></span>
<span id="cb13-30"><a href="#cb13-30"></a>df_with_nan <span class="op">=</span> df.copy()</span>
<span id="cb13-31"><a href="#cb13-31"></a>df_with_nan.loc[<span class="dv">1</span>, <span class="st">'Sales'</span>] <span class="op">=</span> np.nan</span>
<span id="cb13-32"><a href="#cb13-32"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">DataFrame with NaN:"</span>)</span>
<span id="cb13-33"><a href="#cb13-33"></a><span class="bu">print</span>(df_with_nan)</span>
<span id="cb13-34"><a href="#cb13-34"></a></span>
<span id="cb13-35"><a href="#cb13-35"></a><span class="co"># Sort with NaN values at the end (default)</span></span>
<span id="cb13-36"><a href="#cb13-36"></a>df_sorted_nan <span class="op">=</span> df_with_nan.sort_values(by<span class="op">=</span><span class="st">'Sales'</span>)</span>
<span id="cb13-37"><a href="#cb13-37"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Sorted with NaN at the end (default):"</span>)</span>
<span id="cb13-38"><a href="#cb13-38"></a><span class="bu">print</span>(df_sorted_nan)</span>
<span id="cb13-39"><a href="#cb13-39"></a></span>
<span id="cb13-40"><a href="#cb13-40"></a><span class="co"># Sort with NaN values at the beginning</span></span>
<span id="cb13-41"><a href="#cb13-41"></a>df_sorted_nan_first <span class="op">=</span> df_with_nan.sort_values(by<span class="op">=</span><span class="st">'Sales'</span>, na_position<span class="op">=</span><span class="st">'first'</span>)</span>
<span id="cb13-42"><a href="#cb13-42"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Sorted with NaN at the beginning:"</span>)</span>
<span id="cb13-43"><a href="#cb13-43"></a><span class="bu">print</span>(df_sorted_nan_first)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Key parameters for <code>.sort_values()</code>: - <code>by</code>: Column name(s) to sort by</p>
<ul>
<li><p><code>ascending</code>: Whether to sort in ascending order (True) or descending (False)</p></li>
<li><p><code>na_position</code>: Where to position NaN values (‘last’ or ‘first’)</p></li>
<li><p><code>inplace</code>: Whether to modify the original DataFrame</p></li>
</ul>
</section>
<section id="sorting-by-index-.sort_index" class="level2">
<h2 class="anchored" data-anchor-id="sorting-by-index-.sort_index">5.2 Sorting by Index (<code>.sort_index()</code>)</h2>
<p>Sort a DataFrame by its index labels:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co"># Create DataFrame with unsorted index</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>data <span class="op">=</span> {<span class="st">'Sales'</span>: [<span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">100</span>, <span class="dv">300</span>]}</span>
<span id="cb14-5"><a href="#cb14-5"></a>unsorted_index <span class="op">=</span> [<span class="st">'D'</span>, <span class="st">'B'</span>, <span class="st">'A'</span>, <span class="st">'C'</span>]</span>
<span id="cb14-6"><a href="#cb14-6"></a>df <span class="op">=</span> pd.DataFrame(data, index<span class="op">=</span>unsorted_index)</span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="bu">print</span>(<span class="st">"DataFrame with unsorted index:"</span>)</span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="bu">print</span>(df)</span>
<span id="cb14-9"><a href="#cb14-9"></a></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co"># Sort by index (ascending)</span></span>
<span id="cb14-11"><a href="#cb14-11"></a>df_sorted <span class="op">=</span> df.sort_index()</span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Sorted by index (ascending):"</span>)</span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="bu">print</span>(df_sorted)</span>
<span id="cb14-14"><a href="#cb14-14"></a></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="co"># Sort by index (descending)</span></span>
<span id="cb14-16"><a href="#cb14-16"></a>df_sorted_desc <span class="op">=</span> df.sort_index(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Sorted by index (descending):"</span>)</span>
<span id="cb14-18"><a href="#cb14-18"></a><span class="bu">print</span>(df_sorted_desc)</span>
<span id="cb14-19"><a href="#cb14-19"></a></span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="co"># Sort by column names (with multiple columns)</span></span>
<span id="cb14-21"><a href="#cb14-21"></a>df_multi <span class="op">=</span> pd.DataFrame({</span>
<span id="cb14-22"><a href="#cb14-22"></a>    <span class="st">'B'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb14-23"><a href="#cb14-23"></a>    <span class="st">'A'</span>: [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>],</span>
<span id="cb14-24"><a href="#cb14-24"></a>    <span class="st">'C'</span>: [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]</span>
<span id="cb14-25"><a href="#cb14-25"></a>})</span>
<span id="cb14-26"><a href="#cb14-26"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">DataFrame with unsorted columns:"</span>)</span>
<span id="cb14-27"><a href="#cb14-27"></a><span class="bu">print</span>(df_multi)</span>
<span id="cb14-28"><a href="#cb14-28"></a></span>
<span id="cb14-29"><a href="#cb14-29"></a>df_sorted_columns <span class="op">=</span> df_multi.sort_index(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb14-30"><a href="#cb14-30"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Sorted by column names:"</span>)</span>
<span id="cb14-31"><a href="#cb14-31"></a><span class="bu">print</span>(df_sorted_columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Key parameters for <code>.sort_index()</code>: - <code>axis</code>: Sort by row index (<code>0</code> or <code>'index'</code>) or column labels (<code>1</code> or <code>'columns'</code>)</p>
<ul>
<li><p><code>ascending</code>: Whether to sort in ascending order</p></li>
<li><p><code>inplace</code>: Whether to modify the original DataFrame</p></li>
</ul>
</section>
</section>
<section id="managing-duplicates" class="level1">
<h1>6. Managing Duplicates</h1>
<p>Duplicate data can skew analysis results. Pandas provides tools to identify and handle duplicates.</p>
<section id="identifying-duplicates-.duplicated" class="level2">
<h2 class="anchored" data-anchor-id="identifying-duplicates-.duplicated">6.1 Identifying Duplicates (<code>.duplicated()</code>)</h2>
<p>Find duplicate rows in a DataFrame:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co"># Sample data with duplicates</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>data <span class="op">=</span> {</span>
<span id="cb15-5"><a href="#cb15-5"></a>    <span class="st">'Product'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'A'</span>, <span class="st">'C'</span>, <span class="st">'B'</span>, <span class="st">'A'</span>],</span>
<span id="cb15-6"><a href="#cb15-6"></a>    <span class="st">'Region'</span>: [<span class="st">'North'</span>, <span class="st">'South'</span>, <span class="st">'North'</span>, <span class="st">'East'</span>, <span class="st">'South'</span>, <span class="st">'North'</span>],</span>
<span id="cb15-7"><a href="#cb15-7"></a>    <span class="st">'Sales'</span>: [<span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">150</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">150</span>]</span>
<span id="cb15-8"><a href="#cb15-8"></a>}</span>
<span id="cb15-9"><a href="#cb15-9"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="bu">print</span>(<span class="st">"Original DataFrame:"</span>)</span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="bu">print</span>(df)</span>
<span id="cb15-12"><a href="#cb15-12"></a></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="co"># Find duplicate rows (all columns considered)</span></span>
<span id="cb15-14"><a href="#cb15-14"></a>duplicates <span class="op">=</span> df.duplicated()</span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Duplicate rows mask:"</span>)</span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="bu">print</span>(duplicates)</span>
<span id="cb15-17"><a href="#cb15-17"></a></span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="co"># Find duplicate rows (based on specific columns)</span></span>
<span id="cb15-19"><a href="#cb15-19"></a>product_duplicates <span class="op">=</span> df.duplicated(subset<span class="op">=</span>[<span class="st">'Product'</span>])</span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Duplicate Products mask:"</span>)</span>
<span id="cb15-21"><a href="#cb15-21"></a><span class="bu">print</span>(product_duplicates)</span>
<span id="cb15-22"><a href="#cb15-22"></a></span>
<span id="cb15-23"><a href="#cb15-23"></a><span class="co"># Mark all duplicates (including first occurrence)</span></span>
<span id="cb15-24"><a href="#cb15-24"></a>all_duplicates <span class="op">=</span> df.duplicated(keep<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-25"><a href="#cb15-25"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">All duplicates mask (including first occurrences):"</span>)</span>
<span id="cb15-26"><a href="#cb15-26"></a><span class="bu">print</span>(all_duplicates)</span>
<span id="cb15-27"><a href="#cb15-27"></a></span>
<span id="cb15-28"><a href="#cb15-28"></a><span class="co"># Display duplicate rows</span></span>
<span id="cb15-29"><a href="#cb15-29"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Duplicate rows (excluding first occurrences):"</span>)</span>
<span id="cb15-30"><a href="#cb15-30"></a><span class="bu">print</span>(df[df.duplicated()])</span>
<span id="cb15-31"><a href="#cb15-31"></a></span>
<span id="cb15-32"><a href="#cb15-32"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">All rows involved in duplication:"</span>)</span>
<span id="cb15-33"><a href="#cb15-33"></a><span class="bu">print</span>(df[df.duplicated(keep<span class="op">=</span><span class="va">False</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Key parameters for <code>.duplicated()</code>: - <code>subset</code>: Column(s) to consider when identifying duplicates</p>
<ul>
<li><code>keep</code>: Which duplicates to mark:
<ul>
<li><p><code>'first'</code> (default): Mark all except first occurrence</p></li>
<li><p><code>'last'</code>: Mark all except last occurrence</p></li>
<li><p><code>False</code>: Mark all duplicates (including first occurrence)</p></li>
</ul></li>
</ul>
</section>
<section id="removing-duplicates-.drop_duplicates" class="level2">
<h2 class="anchored" data-anchor-id="removing-duplicates-.drop_duplicates">6.2 Removing Duplicates (<code>.drop_duplicates()</code>)</h2>
<p>Remove duplicate rows from a DataFrame:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-2"><a href="#cb16-2"></a></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co"># Sample data with duplicates</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>data <span class="op">=</span> {</span>
<span id="cb16-5"><a href="#cb16-5"></a>    <span class="st">'Product'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'A'</span>, <span class="st">'C'</span>, <span class="st">'B'</span>, <span class="st">'A'</span>],</span>
<span id="cb16-6"><a href="#cb16-6"></a>    <span class="st">'Region'</span>: [<span class="st">'North'</span>, <span class="st">'South'</span>, <span class="st">'North'</span>, <span class="st">'East'</span>, <span class="st">'South'</span>, <span class="st">'North'</span>],</span>
<span id="cb16-7"><a href="#cb16-7"></a>    <span class="st">'Sales'</span>: [<span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">150</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">150</span>]</span>
<span id="cb16-8"><a href="#cb16-8"></a>}</span>
<span id="cb16-9"><a href="#cb16-9"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="bu">print</span>(<span class="st">"Original DataFrame:"</span>)</span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="bu">print</span>(df)</span>
<span id="cb16-12"><a href="#cb16-12"></a></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="co"># Remove duplicates (keep first occurrence)</span></span>
<span id="cb16-14"><a href="#cb16-14"></a>df_deduped <span class="op">=</span> df.drop_duplicates()</span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After removing duplicates (keeping first):"</span>)</span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="bu">print</span>(df_deduped)</span>
<span id="cb16-17"><a href="#cb16-17"></a></span>
<span id="cb16-18"><a href="#cb16-18"></a><span class="co"># Remove duplicates (keep last occurrence)</span></span>
<span id="cb16-19"><a href="#cb16-19"></a>df_deduped_last <span class="op">=</span> df.drop_duplicates(keep<span class="op">=</span><span class="st">'last'</span>)</span>
<span id="cb16-20"><a href="#cb16-20"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After removing duplicates (keeping last):"</span>)</span>
<span id="cb16-21"><a href="#cb16-21"></a><span class="bu">print</span>(df_deduped_last)</span>
<span id="cb16-22"><a href="#cb16-22"></a></span>
<span id="cb16-23"><a href="#cb16-23"></a><span class="co"># Remove duplicates based on specific columns</span></span>
<span id="cb16-24"><a href="#cb16-24"></a>df_deduped_product <span class="op">=</span> df.drop_duplicates(subset<span class="op">=</span>[<span class="st">'Product'</span>])</span>
<span id="cb16-25"><a href="#cb16-25"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After removing duplicates by Product only:"</span>)</span>
<span id="cb16-26"><a href="#cb16-26"></a><span class="bu">print</span>(df_deduped_product)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>.drop_duplicates()</code> uses the same parameters as <code>.duplicated()</code>: - <code>subset</code>: Column(s) to consider when identifying duplicates</p>
<ul>
<li><p><code>keep</code>: Which occurrence to keep (‘first’, ‘last’, or False)</p></li>
<li><p><code>inplace</code>: Whether to modify the original DataFrame</p></li>
</ul>
</section>
</section>
<section id="applied-business-example-cleaning-sales-data" class="level1">
<h1>7. Applied Business Example: Cleaning Sales Data</h1>
<p>Let’s put these techniques together with a comprehensive business example:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co"># Create a messy sales dataset</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>raw_data <span class="op">=</span> {</span>
<span id="cb17-6"><a href="#cb17-6"></a>    <span class="st">'order_id'</span>: [<span class="st">'1001'</span>, <span class="st">'1002'</span>, <span class="dv">1003</span>, <span class="st">'1004'</span>, <span class="st">'1001'</span>],  <span class="co"># Mixed types, duplicate</span></span>
<span id="cb17-7"><a href="#cb17-7"></a>    <span class="st">'date'</span>: [<span class="st">'2025-01-15'</span>, <span class="st">'01/16/2025'</span>, <span class="st">'20250117'</span>, <span class="st">'Jan 18, 2025'</span>, <span class="st">'2025-01-15'</span>],</span>
<span id="cb17-8"><a href="#cb17-8"></a>    <span class="st">'product'</span>: [<span class="st">' Widget A'</span>, <span class="st">'widget a'</span>, <span class="st">'WIDGET B'</span>, <span class="st">'Gadget C '</span>, <span class="st">' Widget A'</span>],  <span class="co"># Inconsistent formatting</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>    <span class="st">'quantity'</span>: [<span class="st">'10'</span>, <span class="st">'5'</span>, <span class="st">'15'</span>, np.nan, <span class="st">'10'</span>],  <span class="co"># Missing value</span></span>
<span id="cb17-10"><a href="#cb17-10"></a>    <span class="st">'unit_price'</span>: [<span class="st">'$25.99'</span>, <span class="st">'15.50'</span>, <span class="st">'$42'</span>, <span class="st">'30.00'</span>, <span class="st">'$25.99'</span>],  <span class="co"># Inconsistent format</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>    <span class="st">'customer_region'</span>: [<span class="st">'north'</span>, <span class="st">'SOUTH'</span>, <span class="st">'South'</span>, <span class="st">'East'</span>, <span class="st">'North'</span>]  <span class="co"># Inconsistent case</span></span>
<span id="cb17-12"><a href="#cb17-12"></a>}</span>
<span id="cb17-13"><a href="#cb17-13"></a>df_sales <span class="op">=</span> pd.DataFrame(raw_data)</span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="bu">print</span>(<span class="st">"Original Messy Sales Data:"</span>)</span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="bu">print</span>(df_sales)</span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Data Types:"</span>)</span>
<span id="cb17-17"><a href="#cb17-17"></a><span class="bu">print</span>(df_sales.dtypes)</span>
<span id="cb17-18"><a href="#cb17-18"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Missing Values:"</span>)</span>
<span id="cb17-19"><a href="#cb17-19"></a><span class="bu">print</span>(df_sales.isnull().<span class="bu">sum</span>())</span>
<span id="cb17-20"><a href="#cb17-20"></a></span>
<span id="cb17-21"><a href="#cb17-21"></a><span class="co"># Step 1: Handle duplicates</span></span>
<span id="cb17-22"><a href="#cb17-22"></a>df_clean <span class="op">=</span> df_sales.drop_duplicates(subset<span class="op">=</span>[<span class="st">'order_id'</span>, <span class="st">'product'</span>])</span>
<span id="cb17-23"><a href="#cb17-23"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After removing duplicates:"</span>)</span>
<span id="cb17-24"><a href="#cb17-24"></a><span class="bu">print</span>(df_clean)</span>
<span id="cb17-25"><a href="#cb17-25"></a></span>
<span id="cb17-26"><a href="#cb17-26"></a><span class="co"># Step 2: Standardize text columns</span></span>
<span id="cb17-27"><a href="#cb17-27"></a>df_clean[<span class="st">'product'</span>] <span class="op">=</span> df_clean[<span class="st">'product'</span>].<span class="bu">str</span>.strip().<span class="bu">str</span>.title()</span>
<span id="cb17-28"><a href="#cb17-28"></a>df_clean[<span class="st">'customer_region'</span>] <span class="op">=</span> df_clean[<span class="st">'customer_region'</span>].<span class="bu">str</span>.title()</span>
<span id="cb17-29"><a href="#cb17-29"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After standardizing text:"</span>)</span>
<span id="cb17-30"><a href="#cb17-30"></a><span class="bu">print</span>(df_clean)</span>
<span id="cb17-31"><a href="#cb17-31"></a></span>
<span id="cb17-32"><a href="#cb17-32"></a><span class="co"># Step 3: Convert data types</span></span>
<span id="cb17-33"><a href="#cb17-33"></a><span class="co"># Clean and convert unit_price</span></span>
<span id="cb17-34"><a href="#cb17-34"></a>df_clean[<span class="st">'unit_price'</span>] <span class="op">=</span> df_clean[<span class="st">'unit_price'</span>].<span class="bu">str</span>.replace(<span class="st">'$'</span>, <span class="st">''</span>).astype(<span class="bu">float</span>)</span>
<span id="cb17-35"><a href="#cb17-35"></a></span>
<span id="cb17-36"><a href="#cb17-36"></a><span class="co"># Convert quantity to numeric (handling missing values)</span></span>
<span id="cb17-37"><a href="#cb17-37"></a>df_clean[<span class="st">'quantity'</span>] <span class="op">=</span> pd.to_numeric(df_clean[<span class="st">'quantity'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb17-38"><a href="#cb17-38"></a></span>
<span id="cb17-39"><a href="#cb17-39"></a><span class="co"># Convert order_id to string</span></span>
<span id="cb17-40"><a href="#cb17-40"></a>df_clean[<span class="st">'order_id'</span>] <span class="op">=</span> df_clean[<span class="st">'order_id'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb17-41"><a href="#cb17-41"></a></span>
<span id="cb17-42"><a href="#cb17-42"></a><span class="co"># Parse dates</span></span>
<span id="cb17-43"><a href="#cb17-43"></a>df_clean[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(df_clean[<span class="st">'date'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb17-44"><a href="#cb17-44"></a></span>
<span id="cb17-45"><a href="#cb17-45"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After type conversion:"</span>)</span>
<span id="cb17-46"><a href="#cb17-46"></a><span class="bu">print</span>(df_clean)</span>
<span id="cb17-47"><a href="#cb17-47"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Data Types:"</span>)</span>
<span id="cb17-48"><a href="#cb17-48"></a><span class="bu">print</span>(df_clean.dtypes)</span>
<span id="cb17-49"><a href="#cb17-49"></a></span>
<span id="cb17-50"><a href="#cb17-50"></a><span class="co"># Step 4: Fill missing values</span></span>
<span id="cb17-51"><a href="#cb17-51"></a><span class="co"># Fill missing quantity with the median</span></span>
<span id="cb17-52"><a href="#cb17-52"></a>median_qty <span class="op">=</span> df_clean[<span class="st">'quantity'</span>].median()</span>
<span id="cb17-53"><a href="#cb17-53"></a>df_clean[<span class="st">'quantity'</span>] <span class="op">=</span> df_clean[<span class="st">'quantity'</span>].fillna(median_qty)</span>
<span id="cb17-54"><a href="#cb17-54"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After filling missing values:"</span>)</span>
<span id="cb17-55"><a href="#cb17-55"></a><span class="bu">print</span>(df_clean)</span>
<span id="cb17-56"><a href="#cb17-56"></a></span>
<span id="cb17-57"><a href="#cb17-57"></a><span class="co"># Step 5: Add calculated columns</span></span>
<span id="cb17-58"><a href="#cb17-58"></a>df_clean[<span class="st">'total_price'</span>] <span class="op">=</span> df_clean[<span class="st">'quantity'</span>] <span class="op">*</span> df_clean[<span class="st">'unit_price'</span>]</span>
<span id="cb17-59"><a href="#cb17-59"></a>df_clean[<span class="st">'order_month'</span>] <span class="op">=</span> df_clean[<span class="st">'date'</span>].dt.month_name()</span>
<span id="cb17-60"><a href="#cb17-60"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After adding calculated columns:"</span>)</span>
<span id="cb17-61"><a href="#cb17-61"></a><span class="bu">print</span>(df_clean)</span>
<span id="cb17-62"><a href="#cb17-62"></a></span>
<span id="cb17-63"><a href="#cb17-63"></a><span class="co"># Step 6: Sort by date and order_id</span></span>
<span id="cb17-64"><a href="#cb17-64"></a>df_clean <span class="op">=</span> df_clean.sort_values(by<span class="op">=</span>[<span class="st">'date'</span>, <span class="st">'order_id'</span>])</span>
<span id="cb17-65"><a href="#cb17-65"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Final clean dataset:"</span>)</span>
<span id="cb17-66"><a href="#cb17-66"></a><span class="bu">print</span>(df_clean)</span>
<span id="cb17-67"><a href="#cb17-67"></a></span>
<span id="cb17-68"><a href="#cb17-68"></a><span class="co"># Summary statistics</span></span>
<span id="cb17-69"><a href="#cb17-69"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Summary Statistics:"</span>)</span>
<span id="cb17-70"><a href="#cb17-70"></a><span class="bu">print</span>(df_clean[[<span class="st">'quantity'</span>, <span class="st">'unit_price'</span>, <span class="st">'total_price'</span>]].describe())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This example demonstrates a typical data cleaning workflow: 1. Remove duplicates</p>
<ol start="2" type="1">
<li><p>Standardize text data</p></li>
<li><p>Convert to appropriate data types</p></li>
<li><p>Handle missing values</p></li>
<li><p>Create calculated columns</p></li>
<li><p>Sort the data</p></li>
<li><p>Verify with summary statistics</p></li>
</ol>
</section>
<section id="key-takeaways" class="level1">
<h1>8. Key Takeaways</h1>
<ol type="1">
<li><p><strong>Data Cleaning is Essential</strong>: Real-world data is rarely analysis-ready without cleaning and preparation.</p></li>
<li><p><strong>Missing Value Strategies</strong>: Use <code>.dropna()</code> to remove rows/columns with missing data or <code>.fillna()</code> to replace missing values with meaningful substitutes.</p></li>
<li><p><strong>Data Type Conversion</strong>: Ensure columns have appropriate types with <code>.astype()</code>, <code>pd.to_numeric()</code>, or <code>pd.to_datetime()</code>. Use <code>errors='coerce'</code> for robust handling of problematic values.</p></li>
<li><p><strong>Column Manipulation</strong>: Easily add new columns with calculations, remove unwanted columns with <code>.drop()</code>, and rename columns for clarity with <code>.rename()</code>.</p></li>
<li><p><strong>Function Application</strong>: Transform data using <code>.apply()</code> for row/column-wise operations and <code>.map()</code> for element-wise Series operations.</p></li>
<li><p><strong>String Operations</strong>: The <code>.str</code> accessor provides powerful vectorized methods for text cleaning and manipulation.</p></li>
<li><p><strong>Sorting and Organization</strong>: Arrange data meaningfully with <code>.sort_values()</code> (by column values) and <code>.sort_index()</code> (by index).</p></li>
<li><p><strong>Duplicate Management</strong>: Identify and remove redundant data using <code>.duplicated()</code> and <code>.drop_duplicates()</code>.</p></li>
<li><p><strong>Modular Approach</strong>: Data cleaning often requires multiple steps in a specific sequence; break down complex operations into manageable tasks.</p></li>
<li><p><strong>Verification is Crucial</strong>: Always verify results with <code>.info()</code>, <code>.describe()</code>, and other inspection methods to ensure your cleaning operations worked as expected.</p></li>
</ol>
</section>
<section id="practice-exercises" class="level1">
<h1>Practice Exercises</h1>
<p>Reinforce your learning with these exercises:</p>
<ol type="1">
<li><strong>Sales Data Cleanup</strong>:
<ul>
<li><p>Load a dataset with messy sales records</p></li>
<li><p>Standardize product names and categories</p></li>
<li><p>Convert price columns to numeric</p></li>
<li><p>Fill missing quantities with appropriate values</p></li>
<li><p>Calculate total revenue</p></li>
</ul></li>
<li><strong>Customer Database Processing</strong>:
<ul>
<li><p>Clean inconsistent customer information</p></li>
<li><p>Standardize address fields</p></li>
<li><p>Convert date fields to proper datetime format</p></li>
<li><p>Remove duplicate customer records</p></li>
<li><p>Create a customer segmentation column</p></li>
</ul></li>
<li><strong>Product Inventory Management</strong>:
<ul>
<li><p>Combine data from multiple sources</p></li>
<li><p>Handle missing inventory counts</p></li>
<li><p>Convert units for consistency</p></li>
<li><p>Flag products with low inventory</p></li>
<li><p>Create a report-ready dataset</p></li>
</ul></li>
<li><strong>Time Series Data Preparation</strong>:
<ul>
<li><p>Convert string dates to datetime</p></li>
<li><p>Ensure regular time intervals</p></li>
<li><p>Fill missing time points</p></li>
<li><p>Calculate period-over-period changes</p></li>
<li><p>Identify outliers</p></li>
</ul></li>
<li><strong>Text Data Cleaning</strong>:
<ul>
<li><p>Standardize case and format</p></li>
<li><p>Remove special characters</p></li>
<li><p>Extract meaningful information from text fields</p></li>
<li><p>Create categorical variables from text descriptions</p></li>
<li><p>Remove duplicate content</p></li>
</ul></li>
</ol>
</section>
<section id="resources-for-further-learning" class="level1">
<h1>Resources for Further Learning</h1>
<section id="official-documentation" class="level2">
<h2 class="anchored" data-anchor-id="official-documentation">Official Documentation</h2>
<ul>
<li><p><a href="https://pandas.pydata.org/docs/user_guide/missing_data.html">Pandas Documentation - Missing Data</a></p></li>
<li><p><a href="https://pandas.pydata.org/docs/user_guide/basics.html#dtypes">Pandas Documentation - Data Types</a></p></li>
<li><p><a href="https://pandas.pydata.org/docs/user_guide/text.html">Pandas Documentation - String Methods</a></p></li>
<li><p><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.drop_duplicates.html">Pandas Documentation - Duplicate Data</a></p></li>
</ul>
</section>
<section id="online-tutorials-and-courses" class="level2">
<h2 class="anchored" data-anchor-id="online-tutorials-and-courses">Online Tutorials and Courses</h2>
<ul>
<li><p><a href="https://realpython.com/pandas-dataframe/">Real Python - Pandas DataFrame Tutorial</a></p></li>
<li><p><a href="https://www.kaggle.com/learn/data-cleaning">Kaggle - Data Cleaning Challenge</a></p></li>
<li><p><a href="https://www.datacamp.com/courses/cleaning-data-in-python">DataCamp - Cleaning Data in Python</a></p></li>
</ul>
</section>
<section id="books" class="level2">
<h2 class="anchored" data-anchor-id="books">Books</h2>
<ul>
<li><p>“Python for Data Analysis” by Wes McKinney (Chapter 7)</p></li>
<li><p>“Data Wrangling with Python” by Jacqueline Kazil and Katharine Jarmul</p></li>
<li><p>“Pandas Cookbook” by Theodore Petrou</p></li>
</ul>
</section>
</section>
<section id="glossary" class="level1">
<h1>Glossary</h1>
<ul>
<li><p><strong>Aggregation</strong>: Computation of summary statistics like mean, sum, or count across a dataset</p></li>
<li><p><strong>Category Type</strong>: A special data type for categorical variables that saves memory by storing each unique value only once</p></li>
<li><p><strong>Coercion</strong>: Converting invalid data to <code>NaN</code> during type conversion (<code>errors='coerce'</code>)</p></li>
<li><p><strong>Data Cleaning</strong>: The process of detecting and correcting corrupt, inaccurate, or irrelevant data</p></li>
<li><p><strong>Data Type</strong>: The classification that determines what values a variable can store and what operations can be performed on it</p></li>
<li><p><strong>Data Wrangling</strong>: The process of transforming and mapping data from one format into another</p></li>
<li><p><strong><code>.drop()</code></strong>: Method used to remove specified columns or rows from a DataFrame</p></li>
<li><p><strong><code>.drop_duplicates()</code></strong>: Method that removes duplicate rows from a DataFrame</p></li>
<li><p><strong><code>.dropna()</code></strong>: Method that removes rows or columns with missing values</p></li>
<li><p><strong><code>.duplicated()</code></strong>: Method that returns a boolean Series indicating duplicate rows</p></li>
<li><p><strong><code>.fillna()</code></strong>: Method used to replace missing values with specified values</p></li>
<li><p><strong>Forward Fill (<code>ffill</code>)</strong>: Propagation of the last valid observation forward to fill gaps</p></li>
<li><p><strong>Imputation</strong>: The process of replacing missing data with substituted values</p></li>
<li><p><strong>Lambda Function</strong>: An anonymous function defined with the <code>lambda</code> keyword, often used for simple operations</p></li>
<li><p><strong><code>.map()</code></strong>: Series method for element-wise transformation based on a function, dictionary, or Series</p></li>
<li><p><strong>Mutability</strong>: Whether an object can be changed after creation (DataFrames are mutable)</p></li>
<li><p><strong>NaN (Not a Number)</strong>: The representation of missing values in pandas</p></li>
<li><p><strong><code>.rename()</code></strong>: Method used to change column or index names</p></li>
<li><p><strong><code>.sort_index()</code></strong>: Method that sorts a DataFrame by its index labels</p></li>
<li><p><strong><code>.sort_values()</code></strong>: Method that sorts a DataFrame by values in specified columns</p></li>
<li><p><strong><code>.str</code> Accessor</strong>: Provides vectorized string functions for Series objects</p></li>
<li><p><strong>Type Casting</strong>: Converting data from one type to another (e.g., string to numeric)</p></li>
</ul>
</section>
<section id="next-steps" class="level1">
<h1>Next Steps</h1>
<p>To build on your data manipulation skills:</p>
<ol type="1">
<li><p><strong>Practice Data Cleaning</strong>: Find messy datasets to clean (many available on Kaggle)</p></li>
<li><p><strong>Combine Techniques</strong>: Create data cleaning pipelines that handle multiple issues</p></li>
<li><p><strong>Learn More Advanced Methods</strong>: Explore other Pandas functions not covered in this module</p></li>
<li><p><strong>Consider Performance</strong>: For larger datasets, research performance optimization techniques</p></li>
<li><p><strong>Integrate with Visualization</strong>: Connect clean data to visualization tools</p></li>
</ol>
<p>In future modules, we’ll explore more advanced data analysis techniques with Pandas, including grouping and aggregation, merging and joining datasets, and pivot tables - all building on the cleaning and manipulation skills developed here.</p>
<hr>
<p><strong>Dr.&nbsp;Smith</strong><br>
University of South Florida</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<div style="text-align: center; margin-top: 50px; padding: 20px; border-top: 1px solid #ddd; color: #666; font-size: 0.9em;">
  ISM2411 Python for Business - Version 0.8.6
</div>




</body></html>